<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <title>Следы - Игра</title>
    <link rel="stylesheet" href="css/base.css" />
    <link rel="stylesheet" href="css/game.css" />
    <link rel="stylesheet" href="css/modifiers.css" />
  </head>
  <body class="game-body">
    <div id="global-floating-bg" class="floating-bg floating-bg-global"></div>
    <header class="game-header">
      <div class="player-info">
        <button id="change-player-btn" class="btn-secondary btn-compact">
          Сменить игрока
        </button>
        <span class="player-label">
          Игрок: <span id="player-name-label"></span>
        </span>
      </div>
      <div class="score-info">Очки: <span id="score-label">0</span></div>
      <div class="round-info">
        Раунд: <span id="round-label">1</span> /
        <span id="round-total-label">5</span>
      </div>
      <div class="timer-info">Время: <span id="timer-label">00:00</span></div>
    </header>

    <section id="level-select" class="level-select">
      <div class="level-select-content">
        <h2>Выбери режим</h2>
        <p id="level-hint" class="level-hint">
          Чтоб открыть заметки следопыта, нажми на клавишу "I".
        </p>
        <p id="best-score-label" class="level-hint">
          Лучший результат на выбранных настройках: 0
        </p>

        <div class="difficulty-toggle" id="difficulty-toggle">
          <button class="diff-btn active" data-diff="easy">Легко</button>
          <button class="diff-btn" data-diff="normal">Нормально</button>
          <button class="diff-btn" data-diff="hard">Сложно</button>
        </div>

        <div class="mode-buttons">
          <button
            id="mode-quiz-btn"
            class="btn-secondary menu-btn"
            data-mode-btn="quiz"
          >
            Викторина
          </button>
          <button
            id="mode-maze-btn"
            class="btn-secondary menu-btn"
            data-mode-btn="maze"
          >
            Марафон лабиринтов
          </button>
          <button
            id="mode-reaction-btn"
            class="btn-secondary menu-btn"
            data-mode-btn="reaction"
          >
            Реакция
          </button>
        </div>

        <div class="menu-bottom">
          <button id="leaderboard-btn" class="btn-leaderboard menu-btn-wide">
            Таблица лидеров
          </button>
        </div>
      </div>
    </section>

    <div id="game-main-wrapper" class="hidden">
      <main class="game-main">
        <section class="question-panel">
          <h2>Уровень: <span id="level-label">Легко</span></h2>
          <p id="question-text">
            Выбери след, который принадлежит этому существу:
          </p>

          <div class="owner-wrapper">
            <img id="owner-image" src="" alt="Хозяин следа" />
            <p id="owner-name"></p>
          </div>
          <div class="confirm-wrapper question-confirm">
            <button id="confirm-answer-btn" class="btn-primary menu-btn">
              Подтвердить ответ
            </button>
          </div>
        </section>

        <section class="options-panel">
          <div class="options-actions">
            <button
              id="restart-round-btn"
              class="btn-icon"
              title="Переиграть раунд"
            >
              ↺
            </button>
          </div>
          <h3 id="options-title">Выберите и подтвердите ответ:</h3>
          <p id="view-mode-hint" class="view-mode-hint hidden">
            Режим просмотра: нажмите на кнопку "перезапустить раунд" ↺ в правом
            верхнем углу, чтобы переиграть этот раунд.
          </p>
          <div id="tracks-container" class="tracks-container"></div>

          <div id="maze-area" class="maze-area hidden">
            <div class="maze-instruction">
              Перетащи выбранный след в стартовую клетку (зелёная), затем
              проведи курсор до выхода (красная), не касаясь стен.
            </div>
            <div id="maze" class="maze"></div>
          </div>
        </section>

        <aside class="rounds-panel">
          <h3>Раунды</h3>
          <div id="rounds-list" class="rounds-list"></div>
          <p class="rounds-hint">Выберите раунд на который хотите перейти.</p>
          <div class="end-level-wrapper">
            <button id="end-level-btn" class="btn-secondary">
              Завершить уровень
            </button>
          </div>
        </aside>
      </main>
    </div>

    <div id="feedback-overlay" class="feedback-overlay hidden">
      <div class="feedback-backdrop"></div>
      <div class="feedback-icon" id="feedback-icon"></div>
    </div>

    <div id="level-end-modal" class="modal hidden">
      <div class="modal-backdrop"></div>
      <div class="modal-content">
        <h2 id="modal-title">Уровень завершён</h2>
        <p id="modal-text"></p>

        <div class="modal-buttons">
          <button id="modal-replay-btn" class="btn-primary menu-btn-wide">
            Сыграть ещё раз
          </button>
          <button id="modal-level-select-btn" class="btn-secondary menu-btn-wide">
            Выбор уровня
          </button>
          <button
            id="modal-leaderboard-btn"
            class="btn-leaderboard menu-btn-wide"
          >
            Таблица лидеров
          </button>
        </div>

        <div id="modal-rounds-picker" class="modal-rounds hidden">
          <h3>Выбери раунд для повторного запуска</h3>
          <div id="modal-rounds-list" class="modal-rounds-list"></div>
          <p class="modal-rounds-hint">
            Красный - неправильный ответ. Выбери раунд, чтобы начать с него.
          </p>
        </div>
      </div>
    </div>

    <div id="round-select-modal" class="modal hidden">
      <div class="modal-backdrop"></div>
      <div class="modal-content">
        <div class="modal-rounds">
          <h3>Выбери раунд для повторного запуска</h3>
          <div id="round-select-list" class="modal-rounds-list"></div>
          <p class="modal-rounds-hint">
            Красный - неправильный ответ. Выбери раунд, чтобы начать с него.
          </p>
          <div class="modal-buttons">
            <button id="round-select-cancel" class="btn-secondary">
              Отмена
            </button>
          </div>
        </div>
      </div>
    </div>

    <div id="instruction-modal" class="modal hidden">
      <div class="modal-backdrop"></div>
      <div class="modal-content">
        <h2>Заметки следопыта</h2>
        <p>
          Приветствую тебя, дорогой друг, в увлекательном мире следов! Давай
          разберёмся, как и зачем здесь всё работает. Режим выбирай двойным
          кликом по мини-игре, а сложность — переключателем. Если заблудишься,
          нажми клавишу «I»; окно подскажет, как стать опытным следопытом.
        </p>
        <p>
          <strong>Викторина.</strong> Выбери один правильный след из доступных.
          Но будь внимательнее! Чем дальше ты заходишь, тем запутаннее
          становится след!
        </p>
        <p>
          <strong>Лабиринт.</strong> Выбери правильный след, перетащи его в
          зелёную зону и проведи по лабиринту до красной, не касаясь стен. С
          каждым уровнем лабиринт будет становиться сложнее, и лишь опытный
          следопыт сможет пройти его безупречно.
        </p>
        <p>
          <strong>Реакция.</strong> В уровне «Реакция» ты проверишь свою реакцию
          и внимательность. Будь начеку: только опытный следопыт умеет быстро
          ориентироваться и принимать верные решения. Кликай по правильному
          следу среди появляющихся.
        </p>
        <p>
          <strong>Сложность.</strong> Уровень сложности влияет на скорость игры,
          штрафные очки, время, количество вариантов и итоговую награду.
        </p>
        <p>Успехов в новых начинаниях, следопыт!</p>
        <div class="modal-buttons">
          <button id="instruction-close-btn" class="btn-primary">
            Понятно
          </button>
        </div>
      </div>
    </div>

    <script src="js/tracks.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/game.js"></script>
  </body>
</html>
